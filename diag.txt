
================================================================================
ðŸ” DIAGNOSTIC DES INCOHÃ‰RENCES
================================================================================

1ï¸âƒ£  VÃ‰RIFICATION: RÃ©actions - MÃ©lange de pÃ©riodes
--------------------------------------------------------------------------------
âš ï¸  5 articles avec des rÃ©actions manquantes dans daily_analytics

Article ID   Title                                    Lifetime   90-day     Missing   
--------------------------------------------------------------------------------
2969205      Actually Agile: Against Performance T... 52         9          43        
3068161      Respiration                              30         14         16        
3144468      Beyond the Linear CV                     27         13         14        
2994223      Efficient Laziness at Scale: The Agil... 11         4          7         
2915031      Building with AI without losing contr... 11         5          6         

2ï¸âƒ£  VÃ‰RIFICATION: Calculs de trafic (views/week)
--------------------------------------------------------------------------------
âš ï¸  5 articles avec calculs faussÃ©s (Ã¢ge > 90 jours)

ðŸ’¡ Ces articles ont des vues Google calculÃ©es sur leur Ã¢ge total,
   mais les donnÃ©es ne couvrent que 90 jours max.

   â€¢ I Replaced My $6/Month VPS with a 2017 Laptop and 
     Age: 142 jours
     DonnÃ©es disponibles: ~90 jours max
     Impact: views/week sous-estimÃ©es de 1.6x

   â€¢ WordPress vs Hugo: When Reality Challenges the Spe
     Age: 135 jours
     DonnÃ©es disponibles: ~90 jours max
     Impact: views/week sous-estimÃ©es de 1.5x

   â€¢ AI-Assisted Development
     Age: 128 jours
     DonnÃ©es disponibles: ~90 jours max
     Impact: views/week sous-estimÃ©es de 1.4x

3ï¸âƒ£  VÃ‰RIFICATION: Formats de dates
--------------------------------------------------------------------------------
âš ï¸  Formats de dates inconsistents:
   â€¢ article_metrics      â†’ SQL datetime
   â€¢ daily_analytics      â†’ ISO with T
   â€¢ follower_events      â†’ SQL datetime
   â€¢ comments             â†’ ISO with T

================================================================================
Total issues found: 9
================================================================================

================================================================================
ðŸ”§ RECOMMANDATIONS DE CORRECTION
================================================================================

ðŸ“‹ ACTIONS RECOMMANDÃ‰ES:

1. RÃ©actions manquantes (5 articles):
   âœ… SOLUTION:
      - Modifier quality_analytics.py ligne 112-130
      - Utiliser UNIQUEMENT am.reactions (lifetime)
      - OU documenter clairement que breakdown = 90j seulement

   Code corrigÃ©:

            cursor.execute("""
                SELECT 
                    am.article_id,
                    am.title,
                    MAX(am.reactions) as total_reactions,  -- Lifetime (correct)
                    -- Breakdown disponible seulement sur 90j (optionnel)
                    MAX(da.reactions_like) as reactions_like_90d,
                    MAX(da.reactions_unicorn) as reactions_unicorn_90d,
                    MAX(da.reactions_readinglist) as reactions_bookmark_90d
                FROM article_metrics am
                LEFT JOIN daily_analytics da ON am.article_id = da.article_id
                WHERE am.reactions > 5
                GROUP BY am.article_id
                ORDER BY total_reactions DESC
                LIMIT 10
            """)
            

2. Calculs de trafic faussÃ©s (3 articles):
   âœ… SOLUTION:
      - Modifier traffic_analytics.py ligne 177-186
      - Calculer views/week sur la pÃ©riode de donnÃ©es (90j max)

   Code corrigÃ©:

            # Au lieu de:
            # views_per_week = (google_views / age_days) * 7
            
            # Utiliser:
            data_period_days = min(90, age_days)  # DonnÃ©es max sur 90 jours
            views_per_week = (google_views / data_period_days) * 7
            
            # Ou mieux: compter les jours rÃ©els de donnÃ©es
            cursor.execute("""
                SELECT 
                    COUNT(DISTINCT date) as actual_days_with_data
                FROM daily_analytics
                WHERE article_id = ?
            """, (article_id,))
            actual_days = cursor.fetchone()['actual_days_with_data']
            views_per_week = (google_views / actual_days) * 7 if actual_days > 0 else 0
            

3. Formats de dates inconsistants:
   âœ… SOLUTION:
      - Standardiser avec datetime.fromisoformat()
      - CrÃ©er une fonction utilitaire:

            def parse_api_datetime(date_str: str) -> datetime:
                """Parse datetime from API (handles Z suffix and T separator)"""
                if not date_str:
                    return None
                # API returns ISO format with Z suffix
                return datetime.fromisoformat(date_str.replace('Z', '+00:00'))
            
